<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js webgl - geometry - cube</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				margin: 0px;
				background-color: #000000;
				overflow: hidden;
			}
		</style>
	</head>
	<body>

		<div class="slidecontainer">
			<p style="color:green">Value to be used for control</p>
		  <input type="range" min="0" max="360" value="0" class="slider" id="myRange">
		  <p style="color:red">Value: <span id="showValue"> </span></p>
			</div>
			<!--
			<div>
			
				<button onclick="setMatrixUpdate()"><font color="green">Matrix  </font></button><br>
				<button onclick="setEulerUpdate()"><font color="green">Euler   </font></button><br>
				<button onclick="setCombinedUpdate()"><font color="green">Combined</font></button><br>

			</div>
			-->

		<script src="js/three.js"></script>

		<script src="http://threejs.org/examples/js/loaders/ColladaLoader.js"></script>
		<script src="http://threejs.org/examples/js/controls/OrbitControls.js"></script>

		<script>
			var camera, scene, renderer,controls;
			var box;
			var delta = 0.0;
			var currentUpdateFunction;
			var slider = document.getElementById("myRange");
			var showValue = document.getElementById("showValue");
			var slideValue = slider.value;
			slider.oninput = function() {
				  slideValue = this.value;
				showValue.innerHTML = this.value;
			}
			init();
			animate();
			function init() {
				camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 1000 );
				camera.position.x = 1;
				camera.position.y = 1;
				camera.position.z = 105;
				controls = new THREE.OrbitControls(camera);

				scene = new THREE.Scene();
				//var texture = new THREE.TextureLoader().load( 'textures/crate.gif' );
				var geometry = new THREE.BoxBufferGeometry( 1, 1, 1 );

				//var material = new THREE.MeshBasicMaterial( { map: texture } );
				//var material = new THREE.MeshNormalMaterial(  );
				//mesh = new THREE.Mesh( geometry, material );
				//scene.add( mesh );
				var light = new THREE.AmbientLight( 0x404040 ); // soft white light
				scene.add( light );
				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				document.body.appendChild( renderer.domElement );
				//
				loadBox();
				window.addEventListener( 'resize', onWindowResize, false );
				
				currentUpdateFunction = updateMeshMatrixRotate;
			}
			function loadBox()
			{
			var manager = new THREE.LoadingManager();
			manager.onStart = function ( url, itemsLoaded, itemsTotal ) {

				console.log( 'Started loading file: ' + url + '.\nLoaded ' + itemsLoaded + ' of ' + itemsTotal + ' files.' );

			};

			manager.onLoad = function ( ) {

				console.log( 'Loading complete!');

			};


			manager.onProgress = function ( url, itemsLoaded, itemsTotal ) {

				console.log( 'Loading file: ' + url + '.\nLoaded ' + itemsLoaded + ' of ' + itemsTotal + ' files.' );

			};

			manager.onError = function ( url ) {

				console.log( 'There was an error loading ' + url );

			};	
			
				var loader = new THREE.ColladaLoader( manager );
				loader.load( './data/Build11_dae.dae', function ( collada ) {

					box = collada.scene;
					//plane.position.set(0.4, -100, 0.8);
					//plane.scale.set(250.4, 250, 250.8);
					scene.add(box);

				} );
			}


		
			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
			}
			function animate() { requestAnimationFrame( animate );
				//mesh.rotation.x += 0.005;
				//mesh.rotation.y += 0.01;
				currentUpdateFunction();
				controls.update();
				renderer.render( scene, camera );
			}

			function updateMeshMatrixRotate()
			{


				delta = THREE.Math.degToRad(slideValue); 

				var rotateMatrix = new THREE.Matrix4();
				var euler = new THREE.Euler(0.0,delta,0.0,"XYZ");
				rotateMatrix.makeRotationFromEuler(euler);

				box.matrixAutoUpdate = false;
				box.matrix =rotateMatrix;

			}

		





		</script>

	</body>
</html>
